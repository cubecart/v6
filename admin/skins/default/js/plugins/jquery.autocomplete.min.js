(function(j){var q=13;var n=9;var e=27;var g=37;var l=38;var i=39;var r=40;var o=8;var k=46;function a(t){j("#info").append(f(t)+"<br>")}function d(v){var x=-1;var s=-1;if(typeof v.selectionStart!="undefined"){x=v.selectionStart;s=v.selectionEnd}else{if(document.selection&&document.selection.createRange){var w=document.selection.createRange();var t;try{t=w.duplicate();t.moveToElementText(v)}catch(u){t=v.createTextRange()}t.setEndPoint("EndToStart",w);x=t.text.length;if(x>v.value.length){x=-1}t.setEndPoint("EndToStart",w);s=t.text.length;if(s>v.value.length){s=-1}}}return{start:x,end:s}}function c(t,s){t.focus();if(t.setSelectionRange){t.setSelectionRange(s,s)}else{if(t.createTextRange){m=t.createTextRange();m.moveStart("character",s);m.collapse();m.select()}}}function b(u){var s=[];for(var t=0;t<u.length;t++){if(u[t].id!=undefined&&u[t].value!=undefined){u[t].id=u[t].id+"";u[t].value=u[t].value+"";if(u[t].info!=undefined){u[t].info=u[t].info+""}s.push(u[t])}}return s}function h(t){if(t==undefined||!t){return""}return t.replace("\\","\\\\").replace("*","\\*").replace(".","\\.").replace("/","\\/")}function f(t){if(t==undefined||!t){return""}return t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}function p(t){if(t==undefined||!t){return""}return t.replace(/^\s+/g,"")}j.fn.autocomplete=function(s){return this.each(function(){var x=(j(this).attr("rel").length>0)?j(this).attr("rel"):false;var H=(j(this).attr("id").length>0)?j(this).attr("id"):false;var V=j(this);var K=j(this).get(0);if(!V.is("input:text,input:password,textarea")){return}if(!s&&(!j.isFunction(s.get)||!s.ajax_get)){return}if(V.attr("jqac")=="on"){return}V.attr("jqac","on");V.attr("autocomplete","off");s=j.extend({delay:500,timeout:5000,minchars:3,multi:false,cache:true,height:150,autowidth:false,noresults:"No results"},s);V.keydown(function(X){switch(X.which){case q:if(!W){return true}else{B()}return false;case e:A();return false}return true});V.keypress(function(X){switch(X.keyCode){case q:case e:return false;case l:M(X.keyCode);return false;case r:if(!W){C(Q())}else{M(X.keyCode)}return false}return true});V.keyup(function(X){switch(X.which){case q:case e:case g:case i:case l:case r:return false;default:C(Q())}return true});var T="";var z=0;var O=[];var D=0;var W=false;var S=false;var t=false;var u=false;var v=false;var I=false;var P=V.css("z-index");function Q(){var Y=V.val();if(s.multi){var aa=d(K);var Z=aa.start;for(;Z>0&&Y.charAt(Z-1)!=",";Z--){}var X=aa.start;for(;X<Y.length&&Y.charAt(X)!=",";X++){}var Y=Y.substr(Z,X-Z)}return p(Y)}function w(Z){T=Z;if(s.multi){var ac=V.val();var ab=d(K);var aa=ab.start;for(;aa>0&&ac.charAt(aa-1)!=",";aa--){}var Y=ab.start;for(;Y<ac.length&&ac.charAt(Y)!=",";Y++){}var X=ac.substr(0,aa)+(aa>0?" ":"")+Z+ac.substr(Y);V.val(X);c(K,aa+Z.length+(aa>0?1:0))}else{K.focus();V.val(Z)}}function C(aa){if(aa.length<s.minchars){A();return false}if(s.cache&&aa.length>z&&O.length){var X=[];for(var Y=0;Y<O.length;Y++){var Z=new RegExp("("+h(aa)+")","ig");if(Z.exec(O[Y].value)){X.push(O[Y])}}T=aa;z=aa.length;O=X;y(O);return false}else{clearTimeout(v);T=aa;z=aa.length;v=setTimeout(function(){O=[];if(j.isFunction(s.pre_callback)){s.pre_callback()}if(j.isFunction(s.get)){O=b(s.get(aa));y(O)}else{if(j.isFunction(s.ajax_get)){A();I=setTimeout(N,s.delay);s.ajax_get(aa,E,x)}}},s.delay)}return false}function E(X){R();O=b(X);y(O)}function N(){if(!t){t=j('<div class="jqac-menu"><div class="jqac-loading">Loading</div></div>').get(0);j(t).css("position","absolute");var X=V.offset();j(t).css("left",X.left+"px");j(t).css("top",(X.top+V.height()+2)+"px");if(!s.autowidth){j(t).width(V.width())}j("body").append(t)}j(t).show();setTimeout(R,10000)}function R(){if(t){j(t).hide()}clearTimeout(I)}function y(Y){if(W){j(W).remove()}R();F();W=j('<div class="jqac-menu"></div>').get(0);j(W).css({position:"absolute","z-index":P,"max-height":s.height+"px","overflow-y":"auto"});S=j("<ul></ul>").get(0);j(S).css("list-style","none").css("margin","0px").css("padding","2px").css("overflow","hidden");var ac=new RegExp("("+h(f(T))+")","ig");for(var aa=0;aa<Y.length;aa++){var ad=new String(Y[aa].value);var Z=f(ad).replace(ac,"<em>$1</em>");var ab=j('<span class="jqac-link">'+Z+"</span>").get(0);if(Y[aa].info!=undefined&&Y[aa].info!=""){j(ab).append(j('<div class="jqac-info">'+Y[aa].info+"</div>"))}j(ab).attr("name",aa+1);j(ab).click(function(){B();$('#sidebar_contain input[type="submit"]').prop('disabled', true);$("#add-button").show();$('#sidebar_contain input[type="submit"]').hide()});j(ab).mouseover(function(){U(j(this).attr("name"),true)});var X=j("<li></li>").get(0);j(X).append(ab);j(S).append(X)}if(Y.length==0){j(S).append('<li class="jqac-warning">'+s.noresults+"</li>")}j(W).append(S);var ae=V.offset();j(W).css("left",ae.left+"px");j(W).css("top",(ae.top+V.height()+2)+"px");if(!s.autowidth){j(W).width(V.width())}j(W).mouseover(function(){F()});j(W).mouseout(function(){J()});j("body").append(W);if(j.fn.bgiframe){j(W).bgiframe({height:W.scrollHeight})}if(W.scrollHeight>s.height){j(W).height(s.height);j(W).width(j(W).width()+20)}D=0;u=setTimeout(function(){A()},s.timeout)}function B(){if(D&&O[D-1]){var X=O[D-1];
if(X.affected_value!=undefined&&X.affected_value!=""){w(X.affected_value)}else{w(X.value)}if(j.isFunction(s.callback)){s.callback(O[D-1],H,x)}A()}}function M(X){if(!S||O.length==0){return false}var Y;if(X==r){Y=D+1}else{if(X==l){Y=D-1}}if(Y>j(S).children().size()){Y=1}if(Y<1){Y=j(S).children().size()}U(Y)}function U(Z,Y){if(!S){return false}if(D>0){G()}D=Number(Z);var X=j(S).children().get(D-1);X.className="jqac-highlight";if(!Y){L(X)}F()}function G(){if(!S){return false}if(D>0){j(S).children().get(D-1).className="";D=0}}function A(){F();if(W){j(W).remove();W=false;S=false;D=0}}function L(ab){if(!W){return false}var Y=W.clientHeight;var ac=W.scrollHeight;var aa=W.scrollTop;var X=ab.offsetTop;var Z=X+ab.offsetHeight;if(Z>aa+Y){W.scrollTop=Z-Y}else{if(X<aa){W.scrollTop=X}}return true}function F(){clearTimeout(u)}function J(){clearTimeout(u);u=setTimeout(function(){A()},1000)}})}})($);